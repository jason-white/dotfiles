#!/bin/zsh

# Check that the correct arguments are being used
if [ "$#" -ne 2 ]; then
  echo "Error: You must provide a file name and year"
  exit 1
fi

# Assign arguments to variables
FILENAME=$1
YEAR=$2

# Remove hyphens and replace them with spaces to create the title
TITLE=$(echo "$FILENAME" | sed 's/-/ /g')

cd "/Users/jason/Dev/jasonwhite.us/content/journal/${YEAR}/" || exit

# Get the current date in the required formats
CURRENT_DATE=$(date '+%Y-%m-%d')
CURRENT_DATE_TIME=$(date '+%Y-%m-%dT%H:%M:%S%z')

# Prepend the filename with the current date
PREPENDED_FILENAME="${CURRENT_DATE}_${FILENAME}.md"

# Create the YAML front matter
YAML_CONTENT="---
type: \"journal\"
title: \"$TITLE\"
date: $CURRENT_DATE_TIME
draft: false
thumbnail: \"\"
alt: \"\"
jammin:
  title: \"\"
  href: \"\"
gallery:
  images:
    image1:
      id:
      img: \"\"
      alt: \"\"
      width:
      height:
tags:
- 
---"

# Write the YAML front matter to the file
echo "$YAML_CONTENT" > "$PREPENDED_FILENAME"

# Inform the user (probably not necessary since we open vim)
echo "New link created created: $PREPENDED_FILENAME"

nvim '+ normal ggzzi' "${PREPENDED_FILENAME}"
